window.zenarioNewAB=function(H){(function(a,A,E,I,l,n,J,G,g,p,q,v,F,z,h){a.init=!0;a.welcome=!1;a.baseCSSClass="";a.onKeyUpNum=0;a.sizing=!1;a.documentScrollTop=!1;a.cachedAJAXSnippets={};a.getKey=function(b){return a.focus.key};a.getKeyId=function(b){return a.focus&&a.focus.key?a.focus.key.id:!1};a.getLastKeyId=function(b){return a.getKeyId(b)};a.open=function(b,c,d,f,e,k){if(n.checkIfBoxIsOpen("AdminOrganizer"))return!1;a.templatePrefix=k||"zenario_admin_box";!1===a.documentScrollTop&&(a.documentScrollTop=
$(l.browserIsSafari()?"body":"html").scrollTop());c||(c={});b=(""+b).split("//",2);b[1]&&!c.id&&(c.id=b[1]);b=b[0];a.isOpen=!0;a.callBack=e;a.getRequestKey=c;a.changed={};a.SKColPicker=!1;e=n.microTemplate(a.templatePrefix,{});a.baseCSSClass="zenario_fbAdmin zenario_admin_box zab_"+b;n.openBox(e,a.baseCSSClass,"AdminFloatingBox"+H,!1,800,50,2,!0,!0,".zenario_jqmHead",!1);g("zenario_fbAdminFloatingBox").style.display="none";E.onbeforeunload=n.onbeforeunload;a.start(b,c,d,f)};a.start=function(b,c,d,
f){a.tabHidden=!0;a.differentTab=!1;a.path=v(b,"");a.focus={};a.key=v(c,{});a.tab=d;a.shownTab=!1;a.url=a.getURL();$.post(a.url,{_fill:!0,_values:f?JSON.stringify(f):""},function(b){a.load(b)?(a.tab&&(a.focus.tab=a.tab),delete a.key,delete a.tab,a.sortTabs(),a.initFields(),a.draw()):a.close(!0)},"text")};a.load=function(b){a.loaded=!0;if(!(b=n.readData(b)))return!1;a.callFunctionOnEditors("isDirty")&&a.markAsChanged();a.callFunctionOnEditors("remove");a.welcome?a.focus=b:a.syncAdminBoxFromServerToClient(b,
a.focus);return!a.focus||!a.focus.tabs&&a.focus._location===h?(n.showMessage(z.couldNotOpenBox,!0,"error"),!1):!0};a.initFields=function(){var b,c,d;if(a.focus.tabs)for(b in a.focus.tabs)if(l.has(a.focus.tabs,b)&&!a.isInfoTag(b)&&a.focus.tabs[b]&&a.focus.tabs[b].fields)for(c in a.focus.tabs[b].fields)l.has(a.focus.tabs[b].fields,c)&&!a.isInfoTag(c)&&(d=a.focus.tabs[b].fields[c])&&(d.pick_items&&d.plugin_setting&&d.plugin_setting.use_value_for_plugin_name?a.pickedItemsArray(c,a.value(c,b,!1)):d.load_values_from_organizer_path&&
!d.values&&a.loadValuesFromOrganizerPath(d))};a.loadValuesFromOrganizerPath=function(b){var c,d;if(b.load_values_from_organizer_path&&!b.values&&(b.values={},(d=n.getSKItem(b.load_values_from_organizer_path))&&d.items))for(c in d.items)l.has(d.items,c)&&(a.isInfoTag(c)||(b.values[l.decodeItemIdForStorekeeper(c)]=n.formatSKItemName(d,c)))};a.changeMode=function(){a.editCancelEnabled(a.focus.tab)&&(a.editModeOn()?a.editCancelOrRevert("cancel",a.focus.tab):a.editCancelOrRevert("edit",a.focus.tab))};
a.revertTab=function(){a.changes(a.focus.tab)&&a.revertEnabled(a.focus.tab)&&a.editCancelOrRevert("revert",a.focus.tab)};a.editCancelOrRevert=function(b,c){if(a.focus.tabs[c].edit_mode){var d,f,e;"edit"==b?(f=p(a.focus.tabs[c].edit_mode.format_on_edit),e=p(a.focus.tabs[c].edit_mode.validate_on_edit)):"cancel"==b?(f=p(a.focus.tabs[c].edit_mode.format_on_cancel_edit),e=p(a.focus.tabs[c].edit_mode.validate_on_cancel_edit)):"revert"==b&&(f=p(a.focus.tabs[c].edit_mode.format_on_revert),e=a.errorOnTab(c)||
p(a.focus.tabs[c].edit_mode.validate_on_revert));if(a.focus.tabs[c].fields&&!e)for(var k in a.focus.tabs[c].fields)if(l.has(a.focus.tabs[c].fields,k)&&!a.isInfoTag(k))if(p(a.focus.tabs[c].fields[k].validate_onchange)&&(d=a.readField(k))!==h&&d!=a.focus.tabs[c].fields[k].value){e=!0;break}else!f&&p(a.focus.tabs[c].fields[k].format_onchange)&&(d=a.readField(k))!==h&&d!=a.focus.tabs[c].fields[k].value&&(f=!0);a.focus.tabs[c].edit_mode.on="cancel"!=b;a.changed[c]=!1;e?a.validate(h,h,!0):f?a.format(!0):
(a.wipeTab(),a.redrawTab(!0));a.focus.tab==c&&$("#zenario_abtab").removeClass("zenario_abtab_changed")}};a.clickTab=function(b){a.loaded&&a.validate(b!=a.focus.tab,b)};a.clickButton=function(b,c){"submit"==a.focus.tabs[a.focus.tab].fields[c].type?(a.focus.tabs[a.focus.tab].fields[c].pressed=!0,a.validate(!0)):"toggle"==a.focus.tabs[a.focus.tab].fields[c].type&&((a.focus.tabs[a.focus.tab].fields[c].pressed=!p(a.focus.tabs[a.focus.tab].fields[c].pressed))?$("#"+c).removeClass("not_pressed").addClass("pressed"):
$("#"+c).removeClass("pressed").addClass("not_pressed"),a.validateFormatOrRedrawForField(a.focus.tabs[a.focus.tab].fields[c]))};a.toggleLevelsPressed={};a.togglePressed=function(b,c){var d;d=b?1<b?a.toggleLevelsPressed[b-1]:!0:a.toggleLevelsPressed.last;d===h&&(d=!0);c&&"toggle"==c.type&&(a.toggleLevelsPressed.last=d&&p(c.pressed),b&&(a.toggleLevelsPressed[b]=a.toggleLevelsPressed.last));return d};a.toggleLevel=function(b){return a.toggleLevelsPressed.last};a.format=function(b){!a.SKColPicker&&a.loaded&&
(a.loaded=!1,a.hideTab(),a.checkValues(b),$.post(a.getURL(),{_format:!0,_box:a.syncAdminBoxFromClientToServer()},function(b){a.load(b);a.sortTabs();a.draw()},"text"),n.nowDoingSomething("loading"))};a.validate=function(b,c,d,f){!a.SKColPicker&&a.loaded&&(a.differentTab=b,a.loaded=!1,a.hideTab(b),a.checkValues(d),$.post(a.getURL(),{_validate:!0,_box:a.syncAdminBoxFromClientToServer()},function(b){a.load(b)&&!a.errorOnTab(a.focus.tab)&&c!==h&&(a.focus.tab=c);a.sortTabs();a.switchToATabWithErrors();
a.draw();f&&f()},"text"),n.nowDoingSomething("loading"))};a.switchToATabWithErrors=function(){if(a.focus&&a.focus.tabs&&!a.errorOnTab(a.focus.tab))for(var b in a.sortedTabs)if(l.has(a.sortedTabs,b)){var c=a.sortedTabs[b];if(a.focus.tabs[c]&&!n.hidden(a.focus.tabs[c])&&a.errorOnTab(c))return a.focus.tab=c,!0}return!1};a.save=function(b,c){if(!a.SKColPicker&&a.loaded&&!a.saving){a.saving=!0;a.differentTab=!0;a.loaded=!1;a.hideTab(!0);a.checkValues();var d={_save:!0,_confirm:b?1:"",_save_and_continue:c,
_box:a.syncAdminBoxFromClientToServer()};p(a.focus.download)||a.focus.confirm&&p(a.focus.confirm.download)?a.save2(l.nonAsyncAJAX(a.getURL(),l.urlRequest(d)),c):($.post(a.getURL(),d,function(b){a.save2(b,c)},"text"),n.nowDoingSomething("saving"))}};a.save2=function(b,c){delete a.saving;"\x3c!--Valid--\x3e"==(""+b).substr(0,12)?(b=b.substr(12),"\x3c!--Confirm--\x3e"==(""+b).substr(0,14)?(b=b.substr(14),a.load(b),a.sortTabs(),a.draw(),a.showConfirm(c)):"\x3c!--Download--\x3e"==(""+b).substr(0,15)?(g("zenario_iframe_form").action=
a.getURL(),g("zenario_iframe_form").innerHTML='<input type="hidden" name="_download" value="1"/><input type="hidden" name="_box" value="'+q(a.syncAdminBoxFromClientToServer())+'"/>',g("zenario_iframe_form").submit(),c&&(b=b.substr(15),a.load(b)),a.refreshParentAndClose(!0,c)):"\x3c!--Saved--\x3e"==(""+b).substr(0,12)?(b=b.substr(12),a.load(b),a.refreshParentAndClose(!1,c)):(a.close(),n.showMessage(b,!0,"error"))):(a.load(b),a.sortTabs(),a.switchToATabWithErrors(),a.draw())};a.showConfirm=function(b){if(a.focus&&
a.focus.confirm&&p(a.focus.confirm.show)){var c=a.focus.confirm.message;p(a.focus.confirm.html)||(c=q(c,!0));b='<input type="button" class="submit_selected" value="'+a.focus.confirm.button_message+'" onclick="zenarioAB.save(true, '+p(b)+');"/><input type="button" class="submit" value="'+a.focus.confirm.cancel_button_message+'" onclick="zenarioA.closeFloatingBox();"/>';n.floatingBox(c,b,v(a.focus.confirm.message_type,"none"))}};a.hideTab=function(b){b?($("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").attr("disabled",
"disabled"),$("#zenario_abtab").clearQueue().show().animate({opacity:0.8},200,function(){a.tabHidden=!0;a.draw()})):($("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").attr("disabled","disabled").animate({opacity:0.9},100),a.tabHidden=!0,a.draw())};a.draw=function(){if(a.welcome&&a.focus){a.focus._clear_local_storage&&(delete a.focus._clear_local_storage,l.sClear(!0));if(a.focus._location!==h){I.location.href=l.addBasePath(a.focus._location);return}a.focus._task!==
h&&(a.task=a.focus._task,delete a.focus._task)}(a.isOpen||a.SKColPicker||a.welcome)&&a.loaded&&a.tabHidden&&a.draw2()};a.draw2=function(b){a.SKColPicker=b;if(!a.SKColPicker&&!a.welcome){g("zenario_fbAdminFloatingBox").className=a.baseCSSClass+" "+(a.focus.css_class||"")+" "+(p(a.focus.hide_tab_bar)?"zenario_admin_box_with_tabs_hidden":"zenario_admin_box_with_tabs_shown");!a.focus.tab||a.focus.tabs[a.focus.tab]&&!n.hidden(a.focus.tabs[a.focus.tab])||(a.focus.tab=!1);b=[];for(var c in a.sortedTabs)if(l.has(a.sortedTabs,
c)){var d=a.sortedTabs[c];a.focus.tabs[d]&&!n.hidden(a.focus.tabs[d])&&(a.focus.tab||(a.focus.tab=d),b.push({tabId:d,current:a.focus.tab==d,label:a.focus.tabs[d].label}))}g("zenario_jqmTabs").innerHTML=n.microTemplate(a.templatePrefix+"_tab",b);a.setTitle(a.focus.title);a.showCloseButton();f="";a.focus.save_and_continue_button_message&&(f+='<input id="zenarioAFB_save_and_continue"  type="button" value="'+q(a.focus.save_and_continue_button_message)+'"',f=a.editModeOnBox()?f+' class="submit_selected" onclick="zenarioAB.save(undefined, true);"/>':
f+' class="submit_disabled"/>');f+='<input id="zenarioAFB_save"  type="button" value="'+v(q(a.focus.save_button_message),z.save)+'"';f=a.editModeOnBox()?f+' class="submit_selected" onclick="zenarioAB.save();"/>':f+' class="submit_disabled"/>';a.focus.cancel_button_message&&(f+='<input type="button" value="'+q(a.focus.cancel_button_message)+'" onclick="zenarioAB.close();">');g("zenario_fbButtons").innerHTML=f;a.size();g("zenario_fbAdminFloatingBox").style.display="block"}n.nowDoingSomething(!1);a.welcome&&
$("#zenario_abtab input").add("#zenario_abtab select").add("#zenario_abtab textarea").clearQueue();var f=a.drawFields();if(a.SKColPicker)return f;if(a.welcome&&!1===a.shownTab)a.insertHTML(f),$("#welcome").show({effect:"drop",direction:"up",duration:300,complete:a.addJQueryElementsToTabAndFocusFirstField}),l.addJQueryElements("#zenario_abtab ",!0);else if(a.shownTab==a.focus.tab){if(a.focus.shake===h?a.differentTab&&a.errorOnTab(a.focus.tab):p(a.focus.shake))$(a.welcome?"#welcome":"#zenario_abtab").effect({effect:"bounce",
duration:125,direction:"right",times:2,distance:5,mode:"effect",complete:function(){a.insertHTML(f);$("#zenario_abtab").clearQueue().show().animate({opacity:1},75,function(){l.browserIsIE()&&this.style.removeAttribute("filter");a.addJQueryElementsToTabAndFocusFirstField()});a.hideShowFields()}});else{a.insertHTML(f);var e=a.lastScrollTop;$("#zenario_abtab").clearQueue().show().animate({opacity:1},150,function(){l.browserIsIE()&&this.style.removeAttribute("filter");e!==h?a.addJQueryElementsToTab():
a.addJQueryElementsToTabAndFocusFirstField()});$("#zenario_fbAdminInner").scrollTop(e);a.hideShowFields()}delete a.focus.shake}else a.insertHTML(f),$("#zenario_abtab").clearQueue().show().animate({opacity:1},150,function(){l.browserIsIE()&&this.style.removeAttribute("filter");a.addJQueryElementsToTabAndFocusFirstField()});a.shownTab=a.focus.tab;delete a.lastScrollTop};a.drawFields=function(){n.clearHTML5UploadFromDragDrop();a.sliders={};a.codeEditors={};var b=a.focus.tab,c="",d="";a.savedAndContinued(b)?
d='<div class="zenario_editCancelButton"><input class="submit_disabled" type="button" value="'+z.undoChanges+'"></div>':a.editCancelEnabled(b)&&(d='<div class="zenario_editCancelButton"><input class="submit" type="button" onclick="zenarioAB.changeMode(); return false;" value="'+(a.editModeOn()?z.cancel:z.edit)+'"></div>');var f=v(a.focus.tabs[b].template,a.templatePrefix+"_current_tab"),e=!1,d={fields:{},rows:[],tabId:b,path:a.path,revert:d,errors:[],notices:{}};if(a.editModeOn()){if(a.focus.tabs[b].errors)for(var k in a.focus.tabs[b].errors)l.has(a.focus.tabs[b].errors,
k)&&(a.isInfoTag(k)||d.errors.push({message:a.focus.tabs[b].errors[k]}));if(a.focus.tabs[b].fields)for(var h in a.focus.tabs[b].fields)l.has(a.focus.tabs[b].fields,h)&&!a.isInfoTag(h)&&a.focus.tabs[b].fields[h].error&&d.errors.push({message:a.focus.tabs[b].fields[h].error})}if(a.focus.tabs[b].notices)for(var m in a.focus.tabs[b].notices)l.has(a.focus.tabs[b].notices,m)&&!a.isInfoTag(m)&&p(a.focus.tabs[b].notices[m].show)&&{error:1,warning:1,question:1,success:1}[a.focus.tabs[b].notices[m].type]&&
(d.notices[m]=a.focus.tabs[b].notices[m]);for(h in a.sortedFields[b])l.has(a.sortedFields[b],h)&&(k=a.sortedFields[b][h],m=a.focus.tabs[b].fields[k],m._id=k,m._html=a.drawField(b,k,!0),!1!==m._html&&(!m._startNewRow&&d.rows.length||d.rows.push({fields:[]}),e||a.focus.tabs[b].show_errors_after_field!=k||(d.rows[d.rows.length-1].errors=d.errors,d.rows[d.rows.length-1].notices=d.notices,e=!0),d.rows[d.rows.length-1].fields.push(m),d.fields[k]=m));e||d.rows.splice(0,0,{errors:d.errors,notices:d.notices});
c+=n.microTemplate(f,d);for(h in a.sortedFields[b])l.has(a.sortedFields[b],h)&&(k=a.sortedFields[b][h],delete a.focus.tabs[b].fields[k]._startNewRow,delete a.focus.tabs[b].fields[k]._hideOnOpen,delete a.focus.tabs[b].fields[k]._showOnOpen,delete a.focus.tabs[b].fields[k]._html,delete a.focus.tabs[b].fields[k]._id);return c};a.insertHTML=function(b){var c,d=g("zenario_abtab");d.innerHTML=b;a.tabHidden=!1;a.changes(a.focus.tab)?$(d).addClass("zenario_abtab_changed"):$(d).removeClass("zenario_abtab_changed");
if(a.sliders)for(c in a.sliders)l.has(a.sliders,c)&&$(g(c)).each(function(b,d){var f;if(f=g("zenario_slider_for__"+c))a.sliders[c].min!==h&&(a.sliders[c].min*=1),a.sliders[c].max!==h&&(a.sliders[c].max*=1),a.sliders[c].step!==h&&(a.sliders[c].step*=1),a.sliders[c].disabled=!a.editModeOn(),a.sliders[c].value=$(d).val(),a.sliders[c].slide=function(a,b){$(d).val(b.value)},a.sliders[c].change=function(b,c){this&&this.id&&a.fieldChange(this.id.replace("zenario_slider_for__",""))},$(f).slider(a.sliders[c])});
if(a.codeEditors)for(c in a.codeEditors)if(l.has(a.codeEditors,c)&&(d=ace.edit(c),d.session.setUseSoftTabs(!1),d.setShowPrintMargin(!1),a.codeEditors[c].readonly&&(d.setReadOnly(!0),d.setBehavioursEnabled(!1)),d.session.setOption("useWorker",!1),b=a.codeEditors[c].language))try{b=b.match(/\.twig\.html$/i)?"ace/mode/twig":b.match(/\./)?ace.require("ace/ext/modelist").getModeForPath(b).mode:"ace/mode/"+b,d.session.setMode(b)}catch(f){console.log("Ace editor could not load that language",b)}};a.hideShowFields=
function(a){var c=$(".zenario_hide_on_open"),d=$(".zenario_hide_row_on_open"),f=$(".zenario_show_on_open"),e=function(a,b){b.style.display="none"};f.length&&!c.length?f.show("blind",200,a):!f.length&&c.length?c.hide("blind",200,function(){d.each(e)}):f.length&&c.length&&(c.each(e),d.each(e),f.show())};a.addJQueryElementsToTab=function(){l.addJQueryElements("#zenario_abtab ",!0)};a.addJQueryElementsToTabAndFocusFirstField=function(){l.addJQueryElements("#zenario_abtab ",!0);a.focusFirstField()};a.focusFirstField=
function(){if(a.focus&&!p(a.focus.tabs[a.focus.tab].disable_autofocus)){var b=-1,c=[],d=h,f;for(f in a.sortedFields[a.focus.tab])if(l.has(a.sortedFields[a.focus.tab],f)){var e=a.sortedFields[a.focus.tab][f],k=a.focus.tabs[a.focus.tab].fields[e];if(g(e)&&$(g(e)).is(":visible")&&(c[++b]={id:e,type:k.type,empty:""==g(e).value,focusable:k.type&&{password:1,checkbox:1,select:1,text:1,textarea:1}[k.type]&&!p(g(e).disabled)&&!p(g(e).readonly)},1<b))break}if(c[0]&&!c[0].empty&&c[1]&&c[1].focusable&&c[1].empty&&
"password"==c[1].type)d=1;else if(c[0]&&c[0].focusable)d=0;else if(c[1]&&c[1].focusable)d=1;else return;setTimeout(function(){g(c[d].id).focus()},50)}};a.focusField=function(){a.fieldToFocus&&g(a.fieldToFocus)&&$(g(a.fieldToFocus)).is(":visible")&&g(a.fieldToFocus).focus();delete a.fieldToFocus};a.setTitle=function(a,c){a?($("#zenario_fbAdminFloatingBox .zenario_jqmTitle").css("display","block"),c||(a=q(a)),g("zenario_jqmTitle").innerHTML=a,n.setTooltipIfTooLarge("#zenario_jqmTitle",a,n.tooltipLengthThresholds.adminBoxTitle)):
$("#zenario_fbAdminFloatingBox .zenario_jqmTitle").css("display","none")};a.showCloseButton=function(){a.focus.cancel_button_message?$("#zenario_fbAdminFloatingBox .zenario_jqmClose").css("display","none"):$("#zenario_fbAdminFloatingBox .zenario_jqmClose").css("display","block")};a.errorOnBox=function(){if(a.focus&&a.focus.tabs)for(tab in a.focus.tabs)if(l.has(a.focus.tabs,tab)&&a.errorOnTab(tab))return!0;return!1};a.errorOnTab=function(b){if(a.focus.tabs[b]&&a.editModeOn(b)){if(a.focus.tabs[b].errors)for(var c in a.focus.tabs[b].errors)if(l.has(a.focus.tabs[b].errors,
c)&&!a.isInfoTag(c))return!0;if(a.focus.tabs[b].fields)for(var d in a.focus.tabs[b].fields)if(l.has(a.focus.tabs[b].fields,d)&&!a.isInfoTag(d)&&a.focus.tabs[b].fields[d].error)return!0}};a.checkValues=function(b){b?a.wipeTab():a.readTab();for(var c in a.focus.tabs)if(l.has(a.focus.tabs,c)&&!a.isInfoTag(c)&&(b=a.editModeOn(c),a.focus.tabs[c].fields))for(var d in a.focus.tabs[c].fields)if(l.has(a.focus.tabs[c].fields,d)&&!a.isInfoTag(d)){var f=a.focus.tabs[c].fields[d];f.snippet||"submit"==f.type||
"toggle"==f.type||(f.current_value===h&&(f.current_value=a.value(d,c,!0)),b&&(f.value===h&&(f.value=a.value(d,c,!1)),f.multiple_edit&&f.multiple_edit._changed===h&&f.multiple_edit.changed!==h&&(f.multiple_edit._changed=f.multiple_edit.changed)))}};a.allowedAtt={id:!0,name:!0,size:!0,maxlength:!0,accesskey:!0,"class":!0,cols:!0,dir:!0,readonly:!0,rows:!0,style:!0,tabindex:!0,title:!0,disabled:!0,onblur:!0,onchange:!0,onclick:!0,ondblclick:!0,onfocus:!0,onmousedown:!0,onmousemove:!0,onmouseout:!0,onmouseover:!0,
onmouseup:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onselect:!0,autocomplete:!0,autofocus:!0,list:!0,max:!0,min:!0,multiple:!0,pattern:!0,placeholder:!0,required:!0,step:!0};a.drawField=function(b,c,d,f,e,k,w,m,g,y){d="";var x=!1,s={"class":""},D={};e===h&&(e=a.focus.tabs[b].fields[c]);w===h&&(w=!a.editModeOn()||p(e.read_only));e.type&&"datetime"==e.type&&(w=!0);if(g===h&&"object"==typeof e.values){g=[];for(var r in e.values)l.has(e.values,r)&&("object"==typeof e.values[r]?n.hidden(e.values[r])||(e.values[r].ord!==
h?g.push([r,e.values[r].ord]):e.values[r].label!==h?g.push([r,e.values[r].label]):g.push([r,r])):g.push([r,e.values[r]]));g.sort(n.sortArray);for(var B in g)l.has(g,B)&&(g[B]=g[B][0])}if(f===h){e.load_values_from_organizer_path&&!e.values&&a.loadValuesFromOrganizerPath(e);e._startNewRow=!p(e.same_row);if(e._startNewRow&&!1!==a.shownTab&&a.shownTab==a.focus.tab&&"editor"!=e.type&&"code_editor"!=e.type&&a.focus.tabs[b].fields[c]._h&&!n.hidden(e))e._showOnOpen=!0,delete a.focus.tabs[b].fields[c]._h;
else if(e._startNewRow&&!1!==a.shownTab&&a.shownTab==a.focus.tab&&"editor"!=e.type&&"code_editor"!=e.type&&!a.focus.tabs[b].fields[c]._h&&n.hidden(e))e._hideOnOpen=!0,a.focus.tabs[b].fields[c]._h=!0;else{if(n.hidden(e))return a.focus.tabs[b].fields[c]._h=!0,!1;delete a.focus.tabs[b].fields[c]._h}r="";var u=!1;e.multiple_edit&&(u=w||e.multiple_edit._changed===h?e.multiple_edit.changed:p(e.multiple_edit._changed),p(e.multiple_edit.disable_when_unchanged)&&!u&&(m=!0),p(e.multiple_edit.hide_ui)||!e.multiple_edit.select_list?
(r+='<input type="checkbox" class="multiple_edit" id="multiple_edit__'+q(c)+'"'+(u?' checked="checked"':""),r=p(e.multiple_edit.hide_ui)?r+' style="display: none;"':w?r+' disabled="disabled"':r+(" onchange=\"zenarioAB.meChange(this.checked, '"+q(c)+"');\""),r+="/> "):(r+='<select class="multiple_edit" id="multiple_edit__'+q(c)+'"',r=w?r+' disabled="disabled"':r+(" onchange=\"zenarioAB.meChange(this.value == 1, '"+q(c)+"');\""),r+='><option value=""'+(u?"":' selected="selected"')+">"+v(e.multiple_edit.select_list.not_changed_label,
z.notChanged)+'</option><option value="1"'+(u?' selected="selected"':"")+">"+v(e.multiple_edit.select_list.changed_label,z.changed)+"</option></select> "));d+=r;e.pre_field_html!==h&&(d+=e.pre_field_html)}e.snippet||k!==h||(k=a.value(c,b,h,!0));k===h&&(k="");if(w||m)s.disabled="disabled";if(e.snippet)e.snippet.html?d+='<span id="snippet__'+q(c)+'">'+e.snippet.html+"</span>":e.snippet.url?d=p(e.snippet.cache)?a.cachedAJAXSnippets[e.snippet.url]?d+a.cachedAJAXSnippets[e.snippet.url]:d+(a.cachedAJAXSnippets[e.snippet.url]=
l.nonAsyncAJAX(l.addBasePath(e.snippet.url))):d+l.nonAsyncAJAX(l.addBasePath(e.snippet.url)):e.snippet.separator&&(d+='<hr class="input_separator"',e.snippet.separator.style&&(d+=' style="'+q(e.snippet.separator.style)+'"'),d+="/>");else if(("checkboxes"==e.type||"radios"==e.type)&&f===h)e.values&&(y=a.pickedItemsArray(e,k),B=$.extend(!0,{},e),B.name=v(e.name,c),B.type="checkboxes"==e.type?"checkbox":"radio",w&&(B.disabled=!0),d+=a.hierarchicalBoxes(b,c,k,e,B,y,m,g));else if(e.upload||e.pick_items)k=
{id:c,wrappedId:"name_for_"+c,readOnly:w,tempReadOnly:m},w?k.pickedItems=a.drawPickedItems(c,!0):(k.pickedItems=a.drawPickedItems(c,!1,m),e.pick_items&&e.pick_items.path&&e.pick_items.min_path&&e.pick_items.target_path&&!p(e.pick_items.hide_select_button)&&(k.select={onclick:"zenarioAB.pickItems('"+q(c)+"');",phrase:e.pick_items.select_phrase||z.selectDotDotDot}),e.upload&&(k.upload={onclick:"zenarioAB.upload('"+q(c)+"');",phrase:e.upload.upload_phrase||z.uploadDotDotDot},p(e.upload.drag_and_drop)&&
a.upload(c,!0),E.Dropbox&&Dropbox.isBrowserSupported()&&(k.dropbox={onclick:"zenarioAB.chooseFromDropbox('"+q(c)+"');",phrase:e.upload.dropbox_phrase||z.dropboxDotDotDot}))),d+=n.microTemplate(a.templatePrefix+"_picked_items",k);else if(e.type){s.onchange="zenarioAB.fieldChange('"+q(c)+"');";e.disabled&&(s["class"]+="disabled ");e.return_key_presses_button&&!w&&(s.onkeyup=v(s.onkeyup,"","")+"if (event.keyCode == 13) {$('#"+q(e.return_key_presses_button)+"').click();}");p(e.multiple_edit)&&!w&&(s.onkeyup=
v(s.onkeyup,"","")+"if (event && event.keyCode == 9) return true; zenarioAB.meMarkChanged('"+q(c)+"', this.value, '"+q(e.value)+"');");s["class"]+="input_"+e.type;if("select"==e.type)e.slider&&(x=!0,d+=a.drawSlider(c,e,w,!0)),d+="<select";else if("textarea"==e.type)d+="<textarea";else if("code_editor"==e.type)d+="<div",s["class"]=" zenario_embedded_ace_editor",a.codeEditors[c]={readonly:w,language:e.language};else if("editor"==e.type)d+="<textarea",s.style="visibility: hidden;",s["class"]=w?" tinymce_readonly":
e.insert_image_button?e.insert_link_button?" tinymce_with_images_and_links":" tinymce_with_images":e.insert_link_button?" tinymce_with_links":" tinymce";else if("submit"==e.type||"toggle"==e.type){d+="<input";s.type="button";if(!w||p(e.can_be_pressed_in_view_mode))D.onclick="zenarioAB.clickButton(this, '"+c+"');",delete s.disabled;"submit"==e.type&&(a.focus.tabs[b].fields[c].pressed=!1);"toggle"==e.type&&(s["class"]+=a.focus.tabs[b].fields[c].pressed?" pressed":" not_pressed")}else"date"==e.type||
"datetime"==e.type?(d+="<input",s.type="text",s["class"]+=" zenario_datepicker",p(e.change_month_and_year)&&(s["class"]+=" zenario_datepicker_change_month_and_year"),s.readonly="readonly",w||(s.onkeyup=v(s.onkeyup,"","")+"zenario.dateFieldKeyUp(this, event, '"+q(c)+"');")):"url"==e.type?(d+="<input",s.type="url",s.onfocus=v(s.onfocus,"","")+"if(!this.value) this.value = 'http://';",s.onblur=v(s.onblur,"","")+"if(this.value == 'http://') this.value = '';"):(e.slider&&(x=!0,d+=a.drawSlider(c,e,w,!0)),
d+="<input",s.type=e.type);if("checkbox"==e.type||"radio"==e.type)p(k)&&(s.checked="checked"),k=h;x&&(s.onchange=v(s.onchange,"","")+"$('#zenario_slider_for__"+c+"').slider('value', $(this).val());",s.onkeyup=v(s.onkeyup,"","")+"$('#zenario_slider_for__"+c+"').slider('value', $(this).val());");f===h?e.id=c:(e.id=c+"___"+f,s["class"]+=" control_for__"+c);"radio"==e.type&&e.name||(e.name=c);m=e;y&&(m=$.extend({},e,y));for(var t in m)if(l.has(m,t)&&a.allowedAtt[t])if("disabled"==t||"readonly"==t){if(p(s[t])||
p(m[t]))d+=" "+t+'="'+t+'"'}else d+=" "+t+'="',s[t]&&(d+=s[t]+" ",delete s[t]),d+=q(m[t]),D[t]&&(d+=" "+D[t],delete D[t]),d+='"';for(t in s)l.has(s,t)&&(d+=" "+t+'="'+q(s[t]),D[t]&&(d+=" "+D[t],delete D[t]),d+='"');for(t in D)l.has(D,t)&&(d+=" "+t+'="'+q(D[t])+'"');"select"==e.type?d+=">":"textarea"==e.type||"editor"==e.type?d+=">"+q(k,!1,"asis")+"</textarea>":"code_editor"==e.type?d+=">"+q(k,!1,"asis")+"</div>":"date"==e.type||"datetime"==e.type?(d+=' value="'+q(l.formatDate(k,"datetime"==e.type))+
'"/>',d+='<input type="hidden" id="_value_for__'+q(c)+'" value="'+q(k)+'"/>',w||a.SKColPicker||(d+='<input type="button" class="zenario_remove_date" value="x" onclick="zenarioAB.blankField(\''+q(c)+"'); zenarioAB.fieldChange('"+q(c)+"');\"/>")):d=k!==h?d+(' value="'+q(k,!1,"asis")+'"/>'):d+"/>";if("select"==e.type){e.empty_value&&(d+='<option value="">'+q(e.empty_value)+"</option>");if(e.values)for(B in g)l.has(g,B)&&(r=g[B],d+='<option value="'+q(r)+'"'+(r==k?' selected="selected"':"")+">"+q(e.values[r],
!1,!0)+"</option>");d+="</select>"}}f===h&&("url"!=e.type||w||(d+='&nbsp; <input type="button" class="submit" value="Test" onclick="if (get(\''+q(c)+"').value) window.open(zenario.addBasePath(get('"+q(c)+"').value));\"/>"),e.post_field_label!==h&&(d+='<label for="'+q(c)+'" id="label_for__'+q(c)+'"> '+q(e.post_field_label)+"</label>"),e.post_field_html!==h&&(d+=e.post_field_html),x&&(d+=a.drawSlider(c,e,w,!1)));return d};a.chooseFromDropbox=function(b){var c;if(!a.focus.tabs[a.focus.tab]||!(c=a.focus.tabs[a.focus.tab].fields[b])||
!c.upload)return!1;c={cancel:function(){n.hideAJAXLoader()},linkType:"direct",multiselect:!!p(c.upload.multi),extensions:c.upload.extensions?_.toArray(c.upload.extensions):h,success:function(c){n.showAJAXLoader();l.multipleAJAX("zenario/ajax.php?method_call=handleAdminBoxAJAX&fetchFromDropbox=1",c,!0,function(c){var d,k,h,m,g;if(!a.focus.tabs[a.focus.tab]||!(h=a.focus.tabs[a.focus.tab].fields[b])||!h.upload)return!1;m=h.current_value;g=p(h.upload.multi);for(d in c)l.has(c,d)&&(k=c[d])&&k.id&&(m=g&&
m?m+(","+k.id):k.id);n.hideAJAXLoader();a.redrawPickedItems(b,h,m)})}};n.showAJAXLoader();Dropbox.choose(c)};a.upload=function(b,c){var d;if(!a.focus.tabs[a.focus.tab]||!(d=a.focus.tabs[a.focus.tab].fields[b])||!d.upload)return!1;d={class_name:d.class_name,upload:d.upload};a.uploadCallback=function(c){if(c){var d,k,h,m,g;if(!a.focus.tabs[a.focus.tab]||!(h=a.focus.tabs[a.focus.tab].fields[b])||!h.upload)return!1;m=h.current_value;g=p(h.upload.multi);for(d in c)l.has(c,d)&&(k=c[d])&&k.id&&(m=g&&m?m+
(","+k.id):k.id);a.redrawPickedItems(b,h,m)}};c?n.setHTML5UploadFromDragDrop(A+"zenario/ajax.php?method_call=handleAdminBoxAJAX",{fileUpload:1},a.uploadCallback,g("zenario_fbAdminInner")):n.action(a,d,h,h,h,{fileUpload:1})};a.uploadComplete=function(b){a.uploadCallback!==h&&a.uploadCallback(b);delete a.uploadCallback};a.drawSlider=function(b,c,d,f){html="";if(p(c.slider.before_field)?f:!f)d&&(html+='<div class="ui-disabled">'),html+='<div id="zenario_slider_for__'+q(b)+'" class="'+q(c.slider["class"])+
'" style="'+q(c.slider.style)+'"></div>',a.sliders[b]=c.slider,d&&(html+="</div>");return html};a.pickedItemsArray=function(a,c){if(!1===c||null===c||c===h||!(0!==c&&"0"!==c||a.values&&(a.values[0]||a.values["0"])))return{};var d=(c+"").split(","),f={},e,k,g,m;a._display_value=!1;for(g in d)l.has(d,g)&&(m=d[g])&&(a.upload&&(k=l.decodeItemIdForStorekeeper(m))&&(k=k.split("/"))&&k[1]?(f[m]=k[1],p(k[2])&&p(k[3])&&(f[m]+=" ["+k[2]+" \u00d7 "+k[3]+"px]")):a.values&&a.values[m]&&"string"==typeof a.values[m]?
f[m]=a.values[m]:a.values&&a.values[m]&&a.values[m].label?f[m]=a.values[m].label:a.pick_items&&(a.pick_items.target_path&&(e=n.getSKItem(a.pick_items.target_path,m))||a.pick_items.path&&a.pick_items.path!=a.pick_items.target_path&&(e=n.getSKItem(a.pick_items.path,m)))?(a.values||(a.values={}),a.values[m]=f[m]=n.formatSKItemName(e,m)):a.upload&&m==1*m&&(k=n.lookupFileDetails(m))?(a.values||(a.values={}),f[m]=k.filename,p(k.width)&&p(k.height)&&(f[m]+=" ["+k.width+" \u00d7 "+k.height+"px]"),a.values[m]=
f[m]):f[m]=m,!1===a._display_value&&(a._display_value=f[m]));return f};a.pickedItemsValue=function(a){var c,d="";if(a)for(c in a)l.has(a,c)&&(d+=(""===d?"":",")+c);return d};a.hierarchicalBoxes=function(b,c,d,f,e,k,g,m,n,y,x,s){var v=1;if(!s)s=0,v=1*f.cols||1;else if(10<s)return"";if(n===h){n={};for(var r in f.values)l.has(f.values,r)&&"object"==typeof f.values[r]&&f.values[r].parent&&(n[f.values[r].parent]=!0)}x||(x={});y&&(x[y]=!0);var B=0,u="",t;s&&(u+='<div class="zenario_hierarchical_box_children" id="'+
q("children_for___"+c+"___"+y)+'">');for(var z in m)if(l.has(m,z)){r=m[z];r==1*r&&(r*=1);var A=h;t="object"==typeof f.values[r]?f.values[r]:{label:f.values[r]};A=t.parent;"0"===A&&(A=!1);if(!y&&!A||y==A){++B>v&&(B=1,u+="<br/>");A=d?!0===d||1===d||"1"===d?!0===r||1===r||"1"===r:k?k[r]!==h?!0:!1:r==d:!r;if("checkboxes"==f.type&&p(f.checking_child_checks_parents)){var C="";y&&(C+="if (this.checked) { for (var cb in "+JSON.stringify(x)+") { get('"+q(c)+"___' + cb).checked = true; } } ");n[r]&&(C+="if (!this.checked) { $('#children_for___' + this.id + ' input').attr('checked', false); } ");
C?e.onchange=f.onchange?C+" "+f.onchange:C:f.onchange?e.onchange=f.onchange:delete e.onchange}else"checkboxes"==f.type&&p(f.checking_parent_checks_children)&&(C="",n[r]&&(C+="if (this.checked) { $('#children_for___' + this.id + ' input').each(function(i, el) {el.checked = true;}) }; "),C?e.onchange=f.onchange?C+" "+f.onchange:C:f.onchange?e.onchange=f.onchange:delete e.onchange);t.pre_field_html!==h&&(u+=t.pre_field_html);u+=a.drawField(b,c,!0,r,e,A,!1,g,m,t);u+='<label for="'+q(c+"___"+r)+'" id="label_for__'+
q(c+"___"+r)+'"> '+q(t.label)+"</label>";t.post_field_html!==h&&(u+=t.post_field_html);null!==t.note_below&&t.note_below!==h&&(u+='<div class="zenario_note_below">'+t.note_below+"</div>");n[r]&&(u+=a.hierarchicalBoxes(b,c,d,f,e,k,g,m,n,r,$.extend(!0,{},x),s+1),B=0)}}s&&(u+="</div>");return u};a.drawPickedItems=function(b,c,d,f){f===h&&(f=a.focus.tab);var e=a.focus.tabs[f].fields[b],k=!1,g,m=a.value(b,f,c),q=a.pickedItemsArray(e,m);f=e.upload&&p(e.upload.reorder_items);for(g in q)if(l.has(q,g)){k=
!0;break}if(k){var k=[],y=[];if(f)for(g in m=m.split(","),m)l.has(m,g)&&y.push([m[g],q[m[g]]]);else{for(g in q)l.has(q,g)&&y.push([g,q[g]]);y.sort(n.sortArray)}for(g=0;g<y.length;++g){var q=y[g][0],x=y[g][1],s,m={id:b,item:q,label:x,first:0==g,last:g==y.length-1,readOnly:c,tempReadOnly:d};e.upload&&(m.isUpload=!0,x=(x=(""+x).match(/(.*?)\.(\w+)$/)||(""+x).match(/(.*?)\.(\w+) \[.*\]$/))&&x[2]?x[2].toLowerCase():"unknown",m.extension=x,s=q==1*q?A+"zenario/file.php?id="+q:A+"zenario/file.php?getUploadedFileInCacheDir="+
encodeURIComponent(q),x.match(/gif|jpg|jpeg|png/)?m.thumbnail={onclick:"zenarioAB.showPickedItemInPopout('"+s+"&popout=1&dummy_filename="+encodeURIComponent("image."+x)+"');",src:s+"&sk=1"}:m.adminDownload=s+"&adminDownload=1",f&&(m.first||(m.nudgeUp={onclick:"zenarioAB.nudge('"+F(b)+"', "+(g-1)+", "+g+");"}),m.last||(m.nudgeDown={onclick:"zenarioAB.nudge('"+F(b)+"', "+g+", "+(g+1)+");"})));c||e.pick_items&&p(e.pick_items.hide_remove_button)||(m.removeButton={onclick:"zenarioAB.removePickedItem('"+
F(b)+"', '"+F(q)+"');"});k.push(m)}}else k={readOnly:c,tempReadOnly:d,noItemSelected:!0,nothing_selected_phrase:v(e.pick_items&&e.pick_items.nothing_selected_phrase,z.nothing_selected)};return n.microTemplate(a.templatePrefix+"_picked_item",k)};a.showPickedItemInPopout=function(b){n.action(a,{popout:{href:b,css_class:"zenario_show_colobox_above_fab"}})};a.pickItems=function(b){if(!a.focus.tabs[a.focus.tab]||!a.focus.tabs[a.focus.tab].fields[b])return!1;var c=a.focus.tabs[a.focus.tab].fields[b],d,
f;if(!(c.pick_items&&c.pick_items.path&&c.pick_items.min_path&&c.pick_items.target_path))return!1;f=c.pick_items.path;p(c.pick_items.multiple_select)||f!=c.pick_items.target_path&&c.pick_items.min_path!=c.pick_items.target_path||!(d=a.readField(b))||-1!=d.indexOf(",")||(f="//"==l.rightHandedSubStr(f,2)?f+d:"/"==l.rightHandedSubStr(f,1)?f+("/"+d):f+("//"+d));a.SKTarget=b;n.SK("zenarioAB","setPickedItems",c.pick_items.multiple_select,f,c.pick_items.target_path,c.pick_items.min_path,c.pick_items.max_path,
c.pick_items.disallow_refiners_looping_on_min_path,h,c.pick_items.one_to_one_choose_phrase,c.pick_items.one_to_many_choose_phrase,h,!0,h,h,h,h,h,h,h,h,c.pick_items)};a.setPickedItems=function(b,c,d,f){b=a.SKTarget;d=a.focus.tabs[a.focus.tab].fields[b];var e=d.current_value===h?d.value:d.current_value,k,g,e=p(d.pick_items.multiple_select)&&e?a.pickedItemsArray(d,e):{};for(k in c._items)if(l.has(c._items,k)&&(g=l.decodeItemIdForStorekeeper(k),d.values||(d.values={}),d.values[g]||(d.values[g]=n.formatSKItemName(f,
k)),e[g]=!0,!p(d.pick_items.multiple_select)))break;a.redrawPickedItems(b,d,e)};a.removePickedItem=function(b,c){var d=a.focus.tabs[a.focus.tab].fields[b],f=d.current_value===h?d.value:d.current_value,f=f.split(","),e;for(e in f)if(l.has(f,e)&&f[e]==c){f.splice(e,1);break}f=f.join(",");a.redrawPickedItems(b,d,f)};a.nudge=function(b,c,d){c*=1;d*=1;var f=a.focus.tabs[a.focus.tab].fields[b],e=f.current_value===h?f.value:f.current_value,e=e.split(",");if(e[c]!==h&&e[d]!==h){var g=e[c];e[c]=e[d];e[d]=
g}e=e.join(",");a.redrawPickedItems(b,f,e)};a.redrawPickedItems=function(b,c,d){"object"==typeof d&&(d=a.pickedItemsValue(d));c.current_value=d;g("name_for_"+b).innerHTML=a.drawPickedItems(b);a.fieldChange(b)};a.changed={};a.changes=function(b){if(a.focus&&a.focus.tab){if(b==h){for(b in a.focus.tabs)if(l.has(a.focus.tabs,b)&&a.changed[b])return!0;return!1}return a.changed[b]}return!1};a.markAsChanged=function(b,c){a.focus&&(b===h&&(b=a.focus.tab),b&&(a.changed[b]||(a.changed[b]=!0),a.focus.tab==b&&
$("#zenario_abtab").addClass("zenario_abtab_changed")))};a.fieldChange=function(b){if(a.focus&&a.focus.tab&&a.focus.tabs[a.focus.tab]&&a.focus.tabs[a.focus.tab].fields[b]){var c=a.focus.tab,d=a.focus.tabs[c].fields[b];a.markAsChanged(c);p(d.multiple_edit)&&a.meMarkChanged(b);a.validateFormatOrRedrawForField(d);a.SKColPicker&&d._change_filter_on_change&&zenarioO.changeFilters()}};a.validateFormatOrRedrawForField=function(b){"object"!=typeof b&&(b=a.focus.tabs[a.focus.tab].fields[b]);var c=p(b.validate_onchange),
d=p(b.format_onchange);b=p(b.redraw_onchange);if(c=c||a.errorOnTab(a.focus.tab)&&(d||b))return a.validate(),!0;if(d)return a.format(),!0;b&&(a.readTab(),a.redrawTab());return b};a.meMarkChanged=function(b,c,d){if(c===h||c!=d)a.focus.tabs[a.focus.tab].fields[b].multiple_edit._changed=!0,a.meSetCheckbox(b,!0)};a.meSetCheckbox=function(a,c){"checkbox"==g("multiple_edit__"+a).type?g("multiple_edit__"+a).checked=c:g("multiple_edit__"+a).value=c?1:""};a.meChange=function(b,c,d){if(b)a.focus.tabs[a.focus.tab].fields[c].multiple_edit._changed=
!0;else{if(!d&&p(a.focus.tabs[a.focus.tab].fields[c].multiple_edit.warn_when_abandoning_changes)&&a.focus.tabs[a.focus.tab].fields[c].multiple_edit.original_value!==h&&a.readField(c)!=a.focus.tabs[a.focus.tab].fields[c].multiple_edit.original_value){d='<input type="button" class="submit_selected" value="'+z.abandonChanges+'" onclick="zenarioAB.meChange(false, \''+q(c)+'\', true);"/><input type="button" class="submit" value="'+z.cancel+'"/>';n.floatingBox(z.abandonChangesConfirm,d,"warning");a.meSetCheckbox(c,
!0);return}a.focus.tabs[a.focus.tab].fields[c].multiple_edit._changed=!1;delete a.focus.tabs[a.focus.tab].fields[c].current_value;d=a.focus.tabs[a.focus.tab].fields[c];var f=d.value;d.multiple_edit.original_value!==h&&(f=a.focus.tabs[a.focus.tab].fields[c].current_value=d.multiple_edit.original_value);g(c)&&!d.pick_items?"checkbox"==g(c).type?g(c).checked=f?!0:!1:$(g(c)).val(v(f,"","")):a.insertHTML(a.drawFields())}p(a.focus.tabs[a.focus.tab].fields[c].multiple_edit.disable_when_unchanged)&&(g(c)&&
(g(c).disabled=!b),$(".control_for__"+c).each(function(a,c){c.disabled=!b;"button"==c.type&&(b?$(c).removeClass("submit_disabled"):$(c).addClass("submit_disabled"))}));a.meSetCheckbox(c,b);a.validateFormatOrRedrawForField(c)};a.value=function(b,c,d,f){c||(c=a.focus.tab);b=a.focus.tabs[c].fields[b];d===h&&(d=!a.editModeOn(c));return b?f||"submit"!=b.type&&"toggle"!=b.type?d||b.current_value===h?b.value!==h?b.value:b.multiple_edit&&b.multiple_edit.original_value!==h?b.multiple_edit.original_value:h:
b.current_value:b.pressed:h};a.readField=function(b){var c=h,d=a.focus.tab,f=a.focus.tabs[d].fields[b];if(!f||f.snippet||"submit"==f.type||"toggle"==f.type)return h;var e=!a.editModeOn()||p(f.read_only),k=a.focus.tabs[d].fields[b]._h;f.multiple_edit&&e&&delete a.focus.tabs[d].fields[b].multiple_edit._changed;if("checkboxes"==f.type||"radios"==f.type){if(!e&&!k&&f.values){var n,k="",m=!0;for(n in f.values)l.has(f.values,n)&&g(b+"___"+n)&&g(b+"___"+n).checked&&(k+=(m?"":",")+n,m=!1);f.current_value=
k}k=!0}else if(f.pick_items||f.upload)k=!0;if(k)return e||f.current_value===h?f.value:f.current_value;if(g("_value_for__"+b))a.focus.tabs[d].fields[b].current_value=c=g("_value_for__"+b).value;else if("editor"!=f.type&&"code_editor"!=f.type||e)!e&&g(b)?a.focus.tabs[d].fields[b].current_value="checkbox"==f.type||"radio"==f.type?c=g(b).checked?!0:!1:c=$(g(b)).val():(delete a.focus.tabs[d].fields[b].current_value,c=f.value);else if(c=h,"editor"==f.type?E.tinyMCE&&tinyMCE.get(b)&&(c=tinyMCE.get(b).getContent()):
"code_editor"==f.type&&(e=ace.edit(b))&&(c=e.getValue()),c!==h&&!1!==c)c=a.focus.tabs[d].fields[b].current_value=c;else return f.current_value===h?f.value:f.current_value;return c};a.blankField=function(b){var c=a.focus.tab;g(b)&&$(g(b)).val("");g("_value_for__"+b)&&(g("_value_for__"+b).value="");a.focus.tabs[c].fields[b].current_value=""};a.readTab=function(){var b=a.focus.tab,c,d={};a.lastScrollTop=$("#zenario_fbAdminInner").scrollTop();for(var f in a.focus.tabs[b].fields)l.has(a.focus.tabs[b].fields,
f)&&(a.isInfoTag(f)||(c=a.readField(f))!==h&&(d[f]=c));return d};a.wipeTab=function(){var b=a.focus.tab,c;for(c in a.focus.tabs[b].fields)l.has(a.focus.tabs[b].fields,c)&&!a.isInfoTag(c)&&(delete a.focus.tabs[b].fields[c].current_value,a.focus.tabs[b].fields[c].multiple_edit&&delete a.focus.tabs[b].fields[c].multiple_edit._changed)};a.redrawTab=function(){a.focus.shake=!1;a.draw2()};a.size=function(){a.sizing&&clearTimeout(a.sizing);g("zenario_fbMain")&&(a.focus&&p(a.focus.hide_tab_bar)?(g("zenario_fbMain").style.top=
"0px",g("zenario_fbButtons").style.paddingBottom="7px",g("zenario_jqmTabs").style.display="none"):(g("zenario_fbMain").style.top="24px",g("zenario_fbButtons").style.paddingBottom="31px",g("zenario_jqmTabs").style.display=l.browserIsIE()?"":"inherit"));if(g("zenario_fbAdminInner")){var b=Math.floor(0.96*$(E).height()-(l.browserIsIE()?210:l.browserIsSafari()?202:205));a.focus.max_height&&b>a.focus.max_height&&(b=a.focus.max_height);a.focus&&p(a.focus.hide_tab_bar)&&(b=1*b+24);0<(b*=1)&&(g("zenario_fbAdminInner").style.height=
b+"px")}a.isOpen&&!1!==a.documentScrollTop&&$(l.browserIsSafari()?"body":"html").scrollTop(0);a.sizing=setTimeout(a.size,250)};a.getURL=function(){++a.onKeyUpNum;return a.welcome?A+"zenario/admin/welcome_ajax.php?_json=1&_ab=1&task="+encodeURIComponent(a.task)+"&get="+encodeURIComponent(JSON.stringify(a.getRequest))+l.urlRequest(v(a.key,a.focus.key)):A+"zenario/admin/ajax.php?_json=1&_ab=1&path="+encodeURIComponent(a.path)+l.urlRequest(a.getRequestKey)};a.editModeOn=function(b){if(!a.focus||!a.focus.tabs)return!1;
b||(b=a.focus.tab);return a.focus.tabs[b].edit_mode?a.focus.tabs[b].edit_mode.on=p(a.focus.tabs[b].edit_mode.enabled)&&(p(a.focus.tabs[b].edit_mode.on)||a.editModeAlwaysOn(b)):!1};a.editModeAlwaysOn=function(b){return a.focus.tabs[b].edit_mode.always_on===h||p(a.focus.tabs[b].edit_mode.always_on)||a.savedAndContinued(b)};a.editCancelEnabled=function(b){return a.focus.tabs[b].edit_mode&&p(a.focus.tabs[b].edit_mode.enabled)&&!a.editModeAlwaysOn(b)};a.revertEnabled=function(b){return a.focus.tabs[b].edit_mode&&
p(a.focus.tabs[b].edit_mode.enabled)&&a.editModeAlwaysOn(b)&&!a.savedAndContinued(b)&&(a.focus.tabs[b].edit_mode.enable_revert===h&&a.focus.key&&a.focus.key.id||p(a.focus.tabs[b].edit_mode.enable_revert))};a.savedAndContinued=function(b){return a.focus.tabs[b]._saved_and_continued};a.editModeOnBox=function(){if(a.focus&&a.focus.tabs&&a.sortedTabs)for(var b in a.sortedTabs)if(l.has(a.sortedTabs,b)&&a.editModeOn(a.sortedTabs[b]))return!0;return!1};a.isInfoTag=function(a){return"class_name"==a||"count"==
a||"ord"==a};a.sortTabs=function(){a.sortedTabs=[];if(a.focus.tabs)for(var b in a.focus.tabs)l.has(a.focus.tabs,b)&&!a.isInfoTag(b)&&a.focus.tabs[b]&&a.sortedTabs.push([b,a.focus.tabs[b].ord]);a.sortedTabs.sort(n.sortArray);a.sortedFields={};for(b in a.sortedTabs)if(l.has(a.sortedTabs,b)){var c=a.sortedTabs[b]=a.sortedTabs[b][0];a.sortFields(c)}};a.sortFields=function(b){a.sortedFields[b]=[];if(a.focus.tabs[b].fields)for(var c in a.focus.tabs[b].fields)l.has(a.focus.tabs[b].fields,c)&&!a.isInfoTag(c)&&
a.focus.tabs[b].fields[c]&&a.sortedFields[b].push([c,a.focus.tabs[b].fields[c].ord]);a.sortedFields[b].sort(n.sortArray);for(c in a.sortedFields[b])l.has(a.sortedFields[b],c)&&(a.sortedFields[b][c]=a.sortedFields[b][c][0])};a.syncAdminBoxFromClientToServer=function(){if(a.welcome)return JSON.stringify(a.focus);var b={};a.syncAdminBoxFromClientToServerR(b,a.focus);return JSON.stringify(b)};a.syncAdminBoxFromClientToServerR=function(b,c,d,f,e,g,l,m){if("object"==typeof c){var n,p;for(p in c)if((n="array")&&
d===h&&"_sync"==p||(n="value")&&f===h&&"_sync"==d&&"session"==p||(n="value")&&f===h&&"_sync"==d&&"cache_dir"==p||(n="array")&&d===h&&"key"==p||(n="value")&&f===h&&"key"==d||(n="value")&&d===h&&"shake"==p||(n="value")&&d===h&&"download"==p||(n="array")&&d===h&&"tabs"==p||(n="array")&&f===h&&"tabs"==d||(n="array")&&e===h&&"tabs"==f&&"edit_mode"==p||(n="value")&&g===h&&"tabs"==e&&"edit_mode"==d&&"on"==p||(n="array")&&e===h&&"tabs"==f&&"fields"==p||(n="array")&&g===h&&"tabs"==e&&"fields"==d||(n="value")&&
l===h&&"tabs"==g&&"fields"==f&&"_h"==p||(n="value")&&l===h&&"tabs"==g&&"fields"==f&&"_h_js"==p||(n="value")&&l===h&&"tabs"==g&&"fields"==f&&"current_value"==p||(n="value")&&l===h&&"tabs"==g&&"fields"==f&&"_display_value"==p||(n="value")&&l===h&&"tabs"==g&&"fields"==f&&"pressed"==p||(n="array")&&l===h&&"tabs"==g&&"fields"==f&&"multiple_edit"==p||(n="value")&&m===h&&"tabs"==l&&"fields"==e&&"multiple_edit"==d&&"_changed"==p)"value"==n?"function"!=typeof c[p]&&"object"!=typeof c[p]&&(b[p]=c[p]):"array"==
n&&"object"==typeof c[p]&&(b[p]={},a.syncAdminBoxFromClientToServerR(b[p],c[p],p,d,f,e,g,l))}};a.syncAdminBoxFromServerToClient=function(b,c){for(var d in b)b[d]["[[__unset__]]"]?delete c[d]:c[d]===h||null===c[d]?c[d]=b[d]:b[d]["[[__replace__]]"]?(delete b[d]["[[__replace__]]"],c[d]=b[d]):"object"!=typeof c[d]?c[d]=b[d]:"object"==typeof c[d]&&"object"!=typeof b[d]?c[d]=b[d]:a.syncAdminBoxFromServerToClient(b[d],c[d])};a.getValueArrayofArrays=function(b){return l.nonAsyncAJAX(a.getURL(),l.urlRequest({_read_values:!0,
_box:a.syncAdminBoxFromClientToServer()}),!b)};a.refreshParentAndClose=function(b,c){n.nowDoingSomething(!1);c||(a.isOpen=!1);if(a.callBack&&!c){var d;(d=a.getValueArrayofArrays())&&a.callBack(a.focus.key,d)}else if(zenarioO.init&&(n.storekeeperWindow||n.checkIfBoxIsOpen("sk"))){d=!1;if(a.focus.key.id!==h)d=a.focus.key.id;else for(var f in a.focus.key)if(l.has(a.focus.key,f)){d=a.focus.key[f];break}zenarioO.refreshToShowItem(d)}else a.focus.key.slotName?(l.refreshPluginSlot(a.focus.key.slotName,""),
G.init&&G.init()):b||c||(a.focus.key.cID?l.goToURL(l.linkToItem(a.focus.key.cID,a.focus.key.cType)):G.init&&l.goToURL(l.linkToItem(l.cID,l.cType,"cVersion="+l.cVersion)));d=a.focus.popout_message;c||a.close();d&&n.showMessage(d,!0,!1);if(c){a.changed={};if(a.focus.tabs)for(f in a.focus.tabs)l.has(a.focus.tabs,f)&&!a.isInfoTag(f)&&a.focus.tabs[f]&&a.editModeOn(f)&&(a.focus.tabs[f]._saved_and_continued=!0);a.sortTabs();a.draw()}};a.close=function(b){a.callFunctionOnEditors("remove");n.nowDoingSomething(!1);
a.sizing&&clearTimeout(a.sizing);b||n.closeFloatingBox();n.closeBox("AdminFloatingBox"+H);a.isOpen=!1;!1!==a.documentScrollTop&&($(l.browserIsSafari()?"body":"html").scrollTop(a.documentScrollTop),a.documentScrollTop=!1);delete a.focus;return!1};a.closeButton=function(b){var c=n.onbeforeunload();(c===h||!b&&confirm(c))&&a.isOpen&&a.close();return!1};a.callFunctionOnEditors=function(b){if(a.focus&&a.focus.tab&&a.focus.tabs[a.focus.tab]&&a.focus.tabs[a.focus.tab].fields&&E.tinyMCE)for(var c in a.focus.tabs[a.focus.tab].fields)if(l.has(a.focus.tabs[a.focus.tab].fields,
c)&&"editor"==a.focus.tabs[a.focus.tab].fields[c].type&&tinyMCE.get(c))if("remove"==b)tinyMCE.get(c).remove();else if("isDirty"==b&&tinyMCE.get(c).isDirty())return!0;return!1};a.validateAlias=function(){l.actAfterDelayIfNotSuperseded("validateAlias",a.validateAliasGo)};a.validateAliasGo=function(){var b={_validate_alias:1,alias:g("alias").value};a.focus.key.cID&&(b.cID=a.focus.key.cID);a.focus.key.cType&&(b.cType=a.focus.key.cType);a.focus.key.equivId&&(b.equivId=a.focus.key.equivId);g("language_id")&&
(b.langId=g("language_id").value);g("update_translations")&&(b.lang_code_in_url="show","update_this"==g("update_translations").value&&g("lang_code_in_url")&&(b.lang_code_in_url=g("lang_code_in_url").value));$.post(A+"zenario/admin/quick_ajax.php",b,function(a){if(!(a=n.readData(a)))return!1;var b="";if(a)for(var f in a)l.has(a,f)&&(b+=(b?"<br />":"")+a[f]);g("alias_warning_display").innerHTML=b},"text")};a.generateAlias=function(a){return a.toLowerCase().replace(/[\u00e1\u00c1\u00e0\u00c0\u00e2\u00c2\u00e5\u00c5\u00e4\u00c4\u00e3\u00c3\u00c6\u00e6\u00e7\u00c7\u00f0\u00d0\u00e9\u00c9\u00e8\u00c8\u00ea\u00ca\u00eb\u00cb\u00ed\u00cd\u00ec\u00cc\u00ee\u00ce\u00ef\u00cf\u00f1\u00d1\u00f3\u00d3\u00f2\u00d2\u00f4\u00d4\u00f6\u00d6\u00f5\u00d5\u00f8\u00d8\u0161\u0160\u00fa\u00da\u00f9\u00d9\u00fb\u00db\u00fc\u00dc\u00fd\u00dd\u017e\u017d]/g,
function(a){return{"\u00e1":"a","\u00c1":"a","\u00e0":"a","\u00c0":"a","\u00e2":"a","\u00c2":"a","\u00e5":"a","\u00c5":"a","\u00e4":"a","\u00c4":"a","\u00e3":"a","\u00c3":"a","\u00c6":"ae","\u00e6":"ae","\u00e7":"c","\u00c7":"c","\u00f0":"d","\u00d0":"d","\u00e9":"e","\u00c9":"e","\u00e8":"e","\u00c8":"e","\u00ea":"e","\u00ca":"e","\u00eb":"e","\u00cb":"e","\u00ed":"i","\u00cd":"i","\u00ec":"i","\u00cc":"i","\u00ee":"i","\u00ce":"i","\u00ef":"i","\u00cf":"i","\u00f1":"n","\u00d1":"n","\u00f3":"o",
"\u00d3":"o","\u00f2":"o","\u00d2":"o","\u00f4":"o","\u00d4":"o","\u00f6":"o","\u00d6":"o","\u00f5":"o","\u00d5":"o","\u00f8":"o","\u00d8":"o","\u0161":"s","\u0160":"s","\u00fa":"u","\u00da":"u","\u00f9":"u","\u00d9":"u","\u00fb":"u","\u00db":"u","\u00fc":"u","\u00dc":"u","\u00fd":"y","\u00dd":"y","\u017e":"z","\u017d":"z"}[a]}).replace(/&/g,"and").replace(/[^a-z0-9\s_-]/g,"").replace(/\s+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-+/g,"-").substr(0,50)};a.contentTitleChange=function(){g("menu_title")&&
!a.focus.___menu_title_changed&&(g("menu_title").value=g("title").value.replace(/\s+/g," "),g("menu_title").onkeyup());g("alias")&&!a.focus.___alias_changed&&(g("alias").value=a.generateAlias(g("title").value),a.validateAlias())};a.viewFrameworkSource=function(){var b=A+"zenario/admin/organizer.php#zenario__modules/show_frameworks//"+a.focus.key.moduleId+"//"+l.encodeItemIdForStorekeeper(a.readField("framework"));E.open(b);return!1};a.adminPermChange=function(b,c,d,f,e){var k=!0;f===h&&(e=0,f=$("input[name="+
c+"]").each(function(a,b){b.checked&&++e}).size());0==e?(k=!1,c="zenario_permgroup_empty"):c=e<f?"zenario_permgroup_half_full":"zenario_permgroup_full";g(b).checked=a.focus.tabs[a.focus.tab].fields[b].current_value=k;$(g("row__"+b)).removeClass("zenario_permgroup_empty").removeClass("zenario_permgroup_half_full").removeClass("zenario_permgroup_full").addClass(c);g(d).value=a.focus.tabs[a.focus.tab].fields[d].value=a.focus.tabs[a.focus.tab].fields[d].current_value=e+"/"+f};a.adminParentPermChange=
function(b,c,d){var f=0,e=0,h="",p=g(b).checked,m=$("input[name="+c+"]"),n;for(n in a.focus.tabs[a.focus.tab].fields[c].values)l.has(a.focus.tabs[a.focus.tab].fields[c].values,n)&&!a.isInfoTag(n)&&(++f,p&&(h+=(h?",":"")+n,++e));m.size()&&m.each(function(a,b){b.checked=p});a.focus.tabs[a.focus.tab].fields[c].current_value=h;a.adminPermChange(b,c,d,f,e)};a.previewDateFormat=function(b,c){l.actAfterDelayIfNotSuperseded(b,function(){a.previewDateFormatGo(b,c)})};a.previewDateFormatGo=function(a,c){(a=
g(a))&&(c=g(c))&&(c.value=l.pluginClassAJAX("zenario_common_features",{previewDateFormat:a.value}))};a.quickValidateWelcomePage=function(b){l.actAfterDelayIfNotSuperseded("quickValidateWelcomePage",a.quickValidateWelcomePageGo,b)};a.quickValidateWelcomePageGo=function(){var b={},c;for(c in a.focus.tabs[a.focus.tab].fields)l.has(a.focus.tabs[a.focus.tab].fields,c)&&(a.isInfoTag(c)||(b[c]=v(a.focus.tabs[a.focus.tab].fields[c].row_class,"","")));$.post(A+"zenario/admin/welcome_ajax.php?quickValidate=1",
{tab:a.focus.tab,path:a.welcome?"":a.path,values:JSON.stringify(a.readTab()),row_classes:JSON.stringify(b)},function(b){if(!(b=n.readData(b)))return!1;if(b&&b.row_classes)for(var c in b.row_classes)l.has(b.row_classes,c)&&a.focus.tabs[a.focus.tab].fields[c]&&g("row__"+c)&&(a.focus.tabs[a.focus.tab].fields[c].row_class=b.row_classes[c],g("row__"+c).className="zenario_ab_row zenario_ab_row__"+c+" "+b.row_classes[c]);if(b&&b.snippets)for(c in b.snippets)l.has(b.snippets,c)&&a.focus.tabs[a.focus.tab].fields[c]&&
a.focus.tabs[a.focus.tab].fields[c].snippet&&a.focus.tabs[a.focus.tab].fields[c].snippet.html&&g("snippet__"+c)&&(a.focus.tabs[a.focus.tab].fields[c].snippet.html=b.snippets[c],g("snippet__"+c).innerHTML=b.snippets[c])},"text");return!0}})(this,URLBasePath,window,document,zenario,zenarioA,zenarioTab,zenarioAT,zenario.get,zenario.engToBoolean,zenario.htmlspecialchars,zenario.ifNull,zenario.jsEscape,zenarioA.phrase)};window.zenarioAB=new zenarioNewAB("");
