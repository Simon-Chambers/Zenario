(function(B,y){function C(f,l){for(var g,b=[],h=0;h<f.length;++h){if(!(g=z[f[h]]))a:{g=B;for(var a=f[h].split(/[.\/]/),q=0;q<a.length;++q){if(!g[a[q]]){g=void 0;break a}g=g[a[q]]}}if(!g)throw"module definition dependecy not found: "+f[h];b.push(g)}l.apply(null,b)}function v(f,l,g){if("string"!==typeof f)throw"invalid module definition, module id must be defined and be a string";if(l===y)throw"invalid module definition, dependencies must be specified";if(g===y)throw"invalid module definition, definition function must be specified";
C(l,function(){z[f]=g.apply(null,arguments)})}var z={};v("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(f,l,g){return{filter:function(b,h){f.each(h,function(a){b=a.constructor==RegExp?b.replace(a,""):b.replace(a[0],a[1])});return b},innerText:function(b){function h(b){var a=b.name,g=b;if("br"===a)e+="\n";else if(r[a]&&(e+=" "),m[a])e+=" ";else{3==b.type&&(e+=b.value);if(!b.shortEnded&&(b=b.firstChild)){do h(b);while(b=b.next)}n[a]&&g.next&&
(e+="\n","p"==a&&(e+="\n"))}}var a=new g,q=new l({},a),e="",r=a.getShortEndedElements(),m=f.makeMap("script noscript style textarea video audio iframe object"," "),n=a.getBlockElements();h(q.parse(b));return e}}});v("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(f,l,g){return function(b){function h(c){var k,d=b.dom;k=b.fire("BeforePastePreProcess",{content:c});k=b.fire("PastePreProcess",k);c=k.content;k.isDefaultPrevented()||(b.hasEventListeners("PastePostProcess")&&
!k.isDefaultPrevented()&&(c=d.add(b.getBody(),"div",{style:"display:none"},c),k=b.fire("PastePostProcess",{node:c}),d.remove(c),c=k.node.innerHTML),k.isDefaultPrevented()||b.insertContent(c))}function a(c){c=b.dom.encode(c).replace(/\r\n/g,"\n");var k=b.dom.getParent(b.selection.getStart(),b.dom.isBlock),d=b.settings.forced_root_block,a;d&&(a=b.dom.createHTML(d,b.settings.forced_root_block_attrs),a=a.substr(0,a.length-3)+">");k&&/^(PRE|DIV)$/.test(k.nodeName)||!d?c=g.filter(c,[[/\n/g,"<br>"]]):(c=
g.filter(c,[[/\n\n/g,"</p>"+a],[/^(.*<\/p>)(<p>)$/,a+"$1"],[/\n/g,"<br />"]]),-1!=c.indexOf("<p>")&&(c=a+c));h(c)}function q(){var c=b.dom,k=b.getBody(),d=b.dom.getViewPort(b.getWin()).y,a=20,e;s=b.selection.getRng();b.inline&&(e=b.selection.getScrollContainer())&&(d=e.scrollTop);if(s.getClientRects)if(a=s.getClientRects(),a.length)a=d+(a[0].top-c.getPos(k).y);else if(a=d,d=s.startContainer)3==d.nodeType&&d.parentNode!=k&&(d=d.parentNode),1==d.nodeType&&(a=c.getPos(d,e||k).y);p=c.add(b.getBody(),
"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"1",style:"position: absolute; top: "+a+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},u);(f.ie||f.gecko)&&c.setStyle(p,"left","rtl"==c.getStyle(k,"direction",!0)?65535:-65535);c.bind(p,"beforedeactivate focusin focusout",function(c){c.stopPropagation()});p.focus();b.selection.select(p,!0)}function e(){if(p){for(var c;c=b.dom.get("mcepastebin");)b.dom.remove(c),b.dom.unbind(c);s&&b.selection.setRng(s)}x=!1;p=s=null}function r(){var c=
u,k,d;k=b.dom.select("div[id=mcepastebin]");for(d=k.length;d--;){var a=k[d].innerHTML;c==u&&(c="");a.length>c.length&&(c=a)}return c}function m(c){var b={};if(c&&c.types){var d=c.getData("Text");d&&0<d.length&&(b["text/plain"]=d);for(d=0;d<c.types.length;d++){var a=c.types[d];b[a]=c.getData(a)}}return b}function n(c,k){function d(c){if("image/png"==a[e].type){var b=new FileReader;b.onload=function(){h('<img src="'+b.result+'">')};b.readAsDataURL(c.getAsFile());return!0}}if(b.settings.paste_data_images&&
!("text/html"in k||"text/plain"in k)&&c.clipboardData){var a=c.clipboardData.items;if(a)for(var e=0;e<a.length;e++)if(d(a[e]))return!0}}function A(c){var a=b.getDoc(),d;a.caretPositionFromPoint?(c=a.caretPositionFromPoint(c.clientX,c.clientY),d=a.createRange(),d.setStart(c.offsetNode,c.offset),d.collapse(!0)):a.caretRangeFromPoint&&(d=a.caretRangeFromPoint(c.clientX,c.clientY));return d}function v(){b.on("keydown",function(c){!c.isDefaultPrevented()&&(l.metaKeyPressed(c)&&86==c.keyCode||c.shiftKey&&
45==c.keyCode)&&(x=c.shiftKey&&86==c.keyCode,c.stopImmediatePropagation(),w=(new Date).getTime(),f.ie&&x?(c.preventDefault(),b.fire("paste",{ieFake:!0})):(e(),q()))});b.on("paste",function(c){var k=m(c.clipboardData||b.getDoc().dataTransfer),d=1E3>(new Date).getTime()-w,l="text"==t.pasteFormat||x;c.isDefaultPrevented()?e():n(c,k)?e():(d||c.preventDefault(),!f.ie||d&&!c.ieFake||(q(),b.dom.bind(p,"paste",function(c){c.stopPropagation()}),b.getDoc().execCommand("Paste",!1,null),k["text/html"]=r()),setTimeout(function(){var c=
r();p&&p.firstChild&&"mcepastebin"===p.firstChild.id&&(l=!0);e();if(c==u||!d)if(c=k["text/html"]||k["text/plain"]||u,c==u){d||b.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.");return}l?a(k["text/plain"]||g.innerText(c)):h(c)},0))});b.on("dragstart",function(c){if(c.dataTransfer.types)try{c.dataTransfer.setData("mce-internal",b.selection.getContent())}catch(a){}});b.on("drop",function(c){var k=A(c);if(k&&!c.isDefaultPrevented()){var d=m(c.dataTransfer),e=d["mce-internal"]||
d["text/html"]||d["text/plain"];e&&(c.preventDefault(),b.undoManager.transact(function(){d["mce-internal"]&&b.execCommand("Delete");b.selection.setRng(k);d["text/html"]?h(e):a(e)}))}})}var t=this,p,s,w=0,u="%MCEPASTEBIN%",x;t.pasteHtml=h;t.pasteText=a;b.on("preInit",function(){v();b.parser.addNodeFilter("img",function(c){if(!b.settings.paste_data_images)for(var a=c.length;a--;){var d=c[a].attributes.map.src;d&&0===d.indexOf("data:image")&&(c[a].attr("data-mce-object")||d===f.transparentSrc||c[a].remove())}})});
b.on("PreProcess",function(){b.dom.remove(b.dom.get("mcepastebin"))})}});v("tinymce/pasteplugin/WordFilter","tinymce/util/Tools tinymce/html/DomParser tinymce/html/Schema tinymce/html/Serializer tinymce/html/Node tinymce/pasteplugin/Utils".split(" "),function(f,l,g,b,h,a){function q(b){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(b)}function e(e){var m=e.settings;e.on("BeforePastePreProcess",function(n){function A(b){function c(c,b,f,
g){var m=c._listLevel||e;m!=e&&(m<e?a&&(a=a.parent.parent):(d=a,a=null));a&&a.name==f?a.append(c):(d=d||a,a=new h(f,1),1<g&&a.attr("start",""+g),c.wrap(a));c.name="li";b.value="";(c=b.next)&&3==c.type&&(c.value=c.value.replace(/^\u00a0+/,""));m>e&&d&&d.lastChild.append(a);e=m}for(var a,d,e=1,g=b.getAll("p"),m=0;m<g.length;m++)if(b=g[m],"p"==b.name&&b.firstChild){for(var f="",n=b.firstChild;n&&!(f=n.value);)n=n.firstChild;if(/^\s*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*$/.test(f))c(b,n,"ul");else if(/^\s*\w+\.$/.test(f)){var f=
/([0-9])\./.exec(f),l=1;f&&(l=parseInt(f[1],10));c(b,n,"ol",l)}else a=null}}function v(a,c){if("p"===a.name){var b=/mso-list:\w+ \w+([0-9]+)/.exec(c);b&&(a._listLevel=parseInt(b[1],10))}if(e.getParam("paste_retain_style_properties","none")){var d="";f.each(e.dom.parseStyle(c),function(c,a){switch(a){case "horiz-align":return;case "vert-align":return;case "font-color":case "mso-foreground":return;case "mso-background":case "mso-highlight":a="background"}if("all"==p||s&&s[a])d+=a+":"+c+";"});if(d)return d}return null}
var t=n.content,p,s;(p=m.paste_retain_style_properties)&&(s=f.makeMap(p));if(!1!==m.paste_enable_default_filters&&q(n.content)){n.wordContent=!0;var t=a.filter(t,[/\x3c!--[\s\S]+?--\x3e/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,c){return 0<c.length?c.replace(/./," ").slice(Math.floor(c.length/
2)).split("").join("\u00a0"):""}]]),w=m.paste_word_valid_elements;w||(w="@[style],-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-table[width],-tr,-td[colspan|rowspan|width],-th,-thead,-tfoot,-tbody,-a[href|name],sub,sup,strike,br");var w=new g({valid_elements:w}),u=new l({},w);u.addAttributeFilter("style",function(a){for(var c=a.length,b;c--;)b=a[c],b.attr("style",v(b,b.attr("style"))),"span"!=b.name||b.attributes.length||b.unwrap()});u.addNodeFilter("a",function(a){for(var c=a.length,
b,d,e;c--;)b=a[c],d=b.attr("href"),e=b.attr("name"),d&&0===d.indexOf("file://")&&(d=d.split("#")[1])&&(d="#"+d),d||e?b.attr({href:d,name:e}):b.unwrap()});t=u.parse(t);A(t);n.content=(new b({},w)).serialize(t)}})}e.isWordContent=q;return e});v("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(f,l,g,b){return function(h){function a(b){h.on("BeforePastePreProcess",function(a){a.content=b(a.content)})}function q(a){return a=
b.filter(a,[/^[\s\S]*\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e[\s\S]*$/g,[/<span class="Apple-converted-space">\u00a0<\/span>/g,"\u00a0"],/<br>$/])}function e(a){if(!g.isWordContent(a))return a;var e=[];l.each(h.schema.getBlockElements(),function(a,b){e.push(b)});var f=RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+e.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");a=b.filter(a,[[f,"$1"]]);return a=b.filter(a,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function r(a){if(h.settings.paste_remove_styles||
!1!==h.settings.paste_remove_styles_if_webkit)a=a.replace(/ style=\"[^\"]+\"/g,"");return a}f.webkit&&(a(r),a(q));f.ie&&a(e)}});v("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(f,l,g,b){var h;f.add("paste",function(a){function f(){"text"==r.pasteFormat?(this.active(!1),r.pasteFormat="html"):(r.pasteFormat="text",this.active(!0),h||(a.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),
h=!0))}var e=this,r,m=a.settings;e.clipboard=r=new l(a);e.quirks=new b(a);e.wordFilter=new g(a);a.settings.paste_as_text&&(e.clipboard.pasteFormat="text");if(m.paste_preprocess)a.on("PastePreProcess",function(a){m.paste_preprocess.call(e,e,a)});if(m.paste_postprocess)a.on("PastePostProcess",function(a){m.paste_postprocess.call(e,e,a)});a.addCommand("mceInsertClipboardContent",function(a,b){b.content&&e.clipboard.pasteHtml(b.content);b.text&&e.clipboard.pasteText(b.text)});if(a.paste_block_drop)a.on("dragend dragover draggesture dragdrop drop drag",
function(a){a.preventDefault();a.stopPropagation()});if(!a.settings.paste_data_images)a.on("drop",function(a){var b=a.dataTransfer;b&&b.files&&0<b.files.length&&a.preventDefault()});a.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:f,active:"text"==e.clipboard.pasteFormat});a.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:r.pasteFormat,onclick:f})})});(function(f){for(var l=0;l<f.length;l++){for(var g=B,b=f[l],h=b.split(/[.\/]/),a=0;a<h.length-1;++a)g[h[a]]===
y&&(g[h[a]]={}),g=g[h[a]];g[h[h.length-1]]=z[b]}})(["tinymce/pasteplugin/Utils","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks","tinymce/pasteplugin/Plugin"])})(this);
